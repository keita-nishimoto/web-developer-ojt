# 課題6（パスワードリセット）

他の課題と同様に [ojt-php](https://github.com/keitakn/ojt-php) をベースに開発を進めて行きましょう。

## アウトプット

ユーザーのパスワードをリセットする機能を作成して下さい。

## 完了条件

以下の条件を満たすようにして下さい。

- ログインページ内に「パスワードを忘れた方はこちら」のリンクが設置されている事
- パスワードリセット完了後は対象ユーザーが持つ全てのログインセッショントークンを無効化する事
- リセット前と同じパスワードは設定出来ないようになっている事

ログインが必要なWebアプリケーションでは必須機能です。

この課題を通じてしっかりと設計方法を学習しましょう。

## ヒント

ざっくりとした流れは以下の通りです。

1. ユーザーが「パスワードを忘れた方はこちら」からパスワードのリセット申請を出す
2. システム側は `1` で受け取ったメールアドレス宛にトークン付きのメールを送信する
3. ユーザーはメールに届いたトークン付きのURLにアクセスする
4. システム側はトークンが正しいかチェックして正しくないトークンの場合はエラーメッセージを出す
5. ユーザーは新しいパスワードを入力する
6. システム側はパスワードをチェックして条件に合わない場合はエラーメッセージを出す
7. システム側はパスワードを変更し、ログインセッショントークンを全て無効化する

流れ的にはユーザー登録と良く似ています。

パスワードを忘れた人が使う機能なので、メールアドレスはユーザーに入力してもらう必要があります。

当然メールアドレスからユーザーIDを特定するのはシステム側の責務です。

どのようなデータ設計が必要か考えてみましょう。

>パスワードリセット完了後は対象ユーザーが持つ全てのログインセッショントークンを無効化する事

これが必要な理由はこの機能が単にパスワードを忘れた時だけではなく、不正ログインをされてパスワードを変更したい時にも利用されるからです。

このようなケースにおいては不正利用を防ぐ為、自身が持つ全てのトークンを無効化する事が期待されます。

## このレッスンで身につける事

セキュリティを考慮したパスワードリセット機能を実装出来るようになる。

## メンター向け

セキュリティ面で漏れがないか重点的にレビューをお願いします。
